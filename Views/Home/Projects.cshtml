@using Microsoft.AspNetCore.Mvc.Localization
@using System.Globalization
@inject IHtmlLocalizer<MermerSitesi.SharedResource> Localizer
@model IEnumerable<MermerSitesi.Models.ProjectItem>

@{
    ViewData["Title"] = Localizer["Projects"];
    // Dil kontrolü: Şu anki dil İngilizce mi?
    bool isEnglish = CultureInfo.CurrentCulture.Name.StartsWith("en");
}

<div class="page-header project-header d-flex align-items-center justify-content-center mb-5" 
     style="background-image: url('https://images.unsplash.com/photo-1600607687939-ce8a6c25118c?q=80&w=1920&auto=format&fit=crop');">
    <div class="text-center text-white position-relative z-index-1">
        <h1 class="display-3 fw-bold" style="font-family: 'Times New Roman', serif; letter-spacing: 3px;">
            @Localizer["Projects"]
        </h1>
        <div class="divider mx-auto bg-white mt-3" style="width: 80px; height: 3px;"></div>
        <p class="mt-3 lead text-uppercase" style="letter-spacing: 2px; font-size: 0.9rem;">
            @Localizer["ProjectsSubtitle"]
        </p>
    </div>
    <div class="overlay"></div>
</div>

<div class="container mb-5">
    <div class="row g-4">
        
        @if (Model != null && !Model.Any())
        {
            <div class="col-12 text-center py-5">
                <div class="alert alert-light border shadow-sm">
                    <h4 class="text-muted">Henüz yayınlanmış bir proje bulunmamaktadır.</h4>
                    <p class="mb-0">Yönetim panelinden yeni proje ekleyebilirsiniz.</p>
                </div>
            </div>
        }
        else
        { 
            @if (Model != null)
            {

            
                @foreach (var item in Model)
                {
                    <div class="col-md-4">
                        <div class="card h-100 border-0 shadow-sm hover-card">
                            <div class="overflow-hidden" style="height: 250px;">
                                @if(!string.IsNullOrEmpty(item.ImageUrl))
                                {
                                    <img src="@item.ImageUrl" class="card-img-top w-100 h-100 object-fit-cover" alt="@item.TitleTr">
                                }
                                else
                                {
                                    <img src="https://via.placeholder.com/400x250?text=Proje" class="card-img-top w-100 h-100 object-fit-cover">
                                }
                            </div>
                            
                            <div class="card-body p-4">
                                <span class="badge bg-black rounded-0 mb-2">@item.CreatedDate.ToString("yyyy")</span>
                                
                                <h5 class="card-title fw-bold mt-2" style="font-family: 'Times New Roman', serif;">
                                    @(isEnglish ? item.TitleEn : item.TitleTr)
                                </h5>
                                
                                <p class="card-text text-muted small line-clamp-3">
                                    @{
                                        var content = isEnglish ? item.ContentEn : item.ContentTr;
                                        if (!string.IsNullOrEmpty(content) && content.Length > 120)
                                        {
                                            @content.Substring(0, 120) <text>...</text>
                                        }
                                        else
                                        {
                                            @content
                                        }
                                    }
                                </p>
                                
                                <a href="#" class="text-uppercase text-dark fw-bold text-decoration-none small" style="letter-spacing: 1px;">
                                    @Localizer["ViewProject"] <i class="fas fa-arrow-right ms-1"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                }
            }
        }

    </div>
</div>